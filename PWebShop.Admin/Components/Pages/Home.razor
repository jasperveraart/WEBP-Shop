@page "/"

<PageTitle>Dashboard</PageTitle>

<div class="dashboard">
    <section class="stats-grid">
        <article class="stat-card pending-users">
            <header class="stat-header">
                <div class="stat-title">Pending user requests</div>
                <div class="stat-icon">ğŸ‘¥</div>
            </header>
            <div class="stat-value">@PendingUserRequests</div>
            <div class="stat-subtitle">Users awaiting approval</div>
        </article>

        <article class="stat-card pending-products">
            <header class="stat-header">
                <div class="stat-title">Pending products</div>
                <div class="stat-icon">ğŸ“</div>
            </header>
            <div class="stat-value">@PendingProducts</div>
            <div class="stat-subtitle">Products pending review</div>
        </article>

        <article class="stat-card daily-orders">
            <header class="stat-header">
                <div class="stat-title">Daily orders</div>
                <div class="stat-icon">ğŸ“Š</div>
            </header>
            <div class="stat-value">@DailyOrdersTotal</div>
            <div class="stat-subtitle">Orders placed today (placeholder)</div>
        </article>
    </section>

    <section class="chart-card">
        <header class="chart-header">
            <div>
                <div class="chart-title">Orders this week</div>
                <div class="chart-subtitle">Placeholder data for quick insights</div>
            </div>
            <div class="chart-legend">Week overview</div>
        </header>

        <div class="chart-grid" role="img" aria-label="Orders per day of the week">
            @foreach (var point in WeeklyOrders)
            {
                <div class="bar-wrapper" aria-label="@point.Day has @point.Count orders">
                    <div class="bar" style=$"height: {GetBarHeight(point.Count)}"></div>
                    <div class="bar-value">@point.Count</div>
                    <div class="bar-label">@point.Day</div>
                </div>
            }
        </div>
    </section>
</div>

@code {
    private int PendingUserRequests => 7;
    private int PendingProducts => 12;
    private int DailyOrdersTotal => 18;

    private List<WeeklyOrderPoint> WeeklyOrders { get; } =
    [
        new("Mon", 12),
        new("Tue", 9),
        new("Wed", 15),
        new("Thu", 7),
        new("Fri", 18),
        new("Sat", 6),
        new("Sun", 10)
    ];

    private string GetBarHeight(int count)
    {
        var max = WeeklyOrders.Max(p => p.Count);
        max = max == 0 ? 1 : max;
        var percentage = Math.Max(8, (int)Math.Round((double)count / max * 100));
        return $"calc({percentage}% - 8px)";
    }

    private record WeeklyOrderPoint(string Day, int Count);
}
